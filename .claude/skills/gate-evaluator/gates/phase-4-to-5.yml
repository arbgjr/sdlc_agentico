---
gate:
  name: "phase-4-to-5"
  from_phase: 4
  to_phase: 5
  description: "Design System & UX → Planning transition"

  required_artifacts:
    - path: "{project_dir}/design/specifications/visual-design-spec.md"
      description: "Visual design specifications"
      validation: "file_exists"

    - path: "{project_dir}/design/design-system/tokens.yml"
      description: "Design tokens (Style Dictionary format)"
      validation: "file_exists_and_valid_yaml"

    - path: "{project_dir}/design/design-system/components/"
      description: "Component specifications (minimum 5)"
      validation: "directory_has_min_files"
      min_files: 5

    - path: "{project_dir}/design/accessibility-checklist.md"
      description: "Accessibility checklist (WCAG AA)"
      validation: "file_exists"

    - path: "{project_dir}/design/handoff/"
      description: "Design handoff documentation"
      validation: "directory_exists"

  quality_checks:
    - check: "Design tokens valid"
      validation: "python3 .claude/lib/python/design_validation.py validate-tokens {project_dir}/design/design-system/tokens.yml"
      severity: "high"

    - check: "Accessibility compliant"
      validation: "python3 .claude/lib/python/design_validation.py check-accessibility {project_dir}/design/"
      severity: "medium"

    - check: "Component specs complete"
      validation: "python3 .claude/lib/python/design_validation.py lint-components {project_dir}/design/design-system/components/"
      severity: "medium"

  approval_required: false
  can_skip: true

  skip_conditions:
    - condition: "complexity_level in [0, 1]"
      reason: "Quick fixes and simple features skip design phase"
    - condition: "project_type == 'backend-only'"
      reason: "Backend-only projects don't require UI design"

  level_overrides:
    0:
      enabled: false
    1:
      enabled: false
    2:
      enabled: true
      approval_required: false
    3:
      enabled: true
      approval_required: true
      reviewers:
        - role: "Design Lead"
        - role: "Accessibility Specialist"

  escalation_triggers:
    - condition: "accessibility_score < 0.70"
      action: "require_human_approval"
    - condition: "missing_core_components > 2"
      action: "block"
    - condition: "token_validation_errors > 0"
      action: "block"

  pass_threshold: 0.80

  success_message: |
    ✅ Design System & UX gate passed!

    Next: Phase 5 (Planning) - delivery-planner will create sprint plan

    Ready to proceed? Run: /gate-check phase-4-to-5 --advance

  metadata:
    created: "2026-02-09"
    version: "1.0.0"
    framework_version: "3.1.0"
