# Inferred Threat Model Template
# Auto-generated by sdlc-import skill using STRIDE methodology

id: "THREAT-MODEL-{{ analysis_id }}"
title: "Threat Model - {{ project_name }}"
status: "inferred"
date: "{{ date }}"
methodology: "STRIDE"
confidence: {{ overall_confidence }}

# Project overview
project:
  name: "{{ project_name }}"
  path: "{{ project_path }}"
  primary_language: "{{ primary_language }}"
  frameworks: {{ frameworks }}

# Architecture summary for threat modeling
architecture_summary: |
  {{ architecture_summary }}

# STRIDE threat categories
threats:
  # Spoofing
  spoofing:
    {% for threat in threats.spoofing %}
    - id: "{{ threat.id }}"
      title: "{{ threat.title }}"
      severity: "{{ threat.severity }}"
      cvss_score: {{ threat.cvss_score }}
      description: |
        {{ threat.description }}
      evidence:
        {% for evidence in threat.evidence %}
        - file: "{{ evidence.file }}"
          line: {{ evidence.line }}
          pattern: "{{ evidence.pattern }}"
        {% endfor %}
      mitigation: |
        {{ threat.mitigation }}
      status: "{{ threat.status }}"
    {% endfor %}

  # Tampering
  tampering:
    {% for threat in threats.tampering %}
    - id: "{{ threat.id }}"
      title: "{{ threat.title }}"
      severity: "{{ threat.severity }}"
      cvss_score: {{ threat.cvss_score }}
      description: |
        {{ threat.description }}
      evidence:
        {% for evidence in threat.evidence %}
        - file: "{{ evidence.file }}"
          line: {{ evidence.line }}
          pattern: "{{ evidence.pattern }}"
        {% endfor %}
      mitigation: |
        {{ threat.mitigation }}
      status: "{{ threat.status }}"
    {% endfor %}

  # Repudiation
  repudiation:
    {% for threat in threats.repudiation %}
    - id: "{{ threat.id }}"
      title: "{{ threat.title }}"
      severity: "{{ threat.severity }}"
      cvss_score: {{ threat.cvss_score }}
      description: |
        {{ threat.description }}
      evidence:
        {% for evidence in threat.evidence %}
        - file: "{{ evidence.file }}"
          line: {{ evidence.line }}
          pattern: "{{ evidence.pattern }}"
        {% endfor %}
      mitigation: |
        {{ threat.mitigation }}
      status: "{{ threat.status }}"
    {% endfor %}

  # Information Disclosure
  information_disclosure:
    {% for threat in threats.information_disclosure %}
    - id: "{{ threat.id }}"
      title: "{{ threat.title }}"
      severity: "{{ threat.severity }}"
      cvss_score: {{ threat.cvss_score }}
      description: |
        {{ threat.description }}
      evidence:
        {% for evidence in threat.evidence %}
        - file: "{{ evidence.file }}"
          line: {{ evidence.line }}
          pattern: "{{ evidence.pattern }}"
        {% endfor %}
      mitigation: |
        {{ threat.mitigation }}
      status: "{{ threat.status }}"
    {% endfor %}

  # Denial of Service
  denial_of_service:
    {% for threat in threats.denial_of_service %}
    - id: "{{ threat.id }}"
      title: "{{ threat.title }}"
      severity: "{{ threat.severity }}"
      cvss_score: {{ threat.cvss_score }}
      description: |
        {{ threat.description }}
      evidence:
        {% for evidence in threat.evidence %}
        - file: "{{ evidence.file }}"
          line: {{ evidence.line }}
          pattern: "{{ evidence.pattern }}"
        {% endfor %}
      mitigation: |
        {{ threat.mitigation }}
      status: "{{ threat.status }}"
    {% endfor %}

  # Elevation of Privilege
  elevation_of_privilege:
    {% for threat in threats.elevation_of_privilege %}
    - id: "{{ threat.id }}"
      title: "{{ threat.title }}"
      severity: "{{ threat.severity }}"
      cvss_score: {{ threat.cvss_score }}
      description: |
        {{ threat.description }}
      evidence:
        {% for evidence in threat.evidence %}
        - file: "{{ evidence.file }}"
          line: {{ evidence.line }}
          pattern: "{{ evidence.pattern }}"
        {% endfor %}
      mitigation: |
        {{ threat.mitigation }}
      status: "{{ threat.status }}"
    {% endfor %}

# Summary statistics
summary:
  total_threats: {{ summary.total_threats }}
  by_severity:
    critical: {{ summary.critical }}
    high: {{ summary.high }}
    medium: {{ summary.medium }}
    low: {{ summary.low }}
  by_category:
    spoofing: {{ summary.spoofing }}
    tampering: {{ summary.tampering }}
    repudiation: {{ summary.repudiation }}
    information_disclosure: {{ summary.information_disclosure }}
    denial_of_service: {{ summary.denial_of_service }}
    elevation_of_privilege: {{ summary.elevation_of_privilege }}

# Escalation recommendations
escalation:
  required: {{ escalation.required }}
  reasons: {{ escalation.reasons }}
  contacts: {{ escalation.contacts }}

# Metadata
metadata:
  analysis_id: "{{ analysis_id }}"
  generated_by: "sdlc-import (security-guidance plugin)"
  plugin_version: "{{ plugin_version }}"

# References
references:
  - "STRIDE Threat Modeling: https://learn.microsoft.com/en-us/azure/security/develop/threat-modeling-tool-threats"
  - "OWASP Top 10: https://owasp.org/www-project-top-ten/"
  - "CWE Top 25: https://cwe.mitre.org/top25/"
